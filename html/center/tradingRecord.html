<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
        <title>交易记录</title>
        <link rel="stylesheet" href="../../css/mui.min.css" />
        <link rel="stylesheet" href="../../css/sanyibao/commo.css" />
        <link rel="stylesheet" href="../../css/sanyibao/tradingRecord.css">
    </head>
    <body class="bg-red">
        <header class="mui-bar mui-bar-nav">
            <h1 class="mui-title">交易记录</h1>
            <div class="shaixuan">
                <img src="../../img/shaixuan.png" alt="">
            </div>
        </header>
        <div style="height: 44px;"></div>
        <div class="main">
            <div class="main-item">
                <p class="top-tit">2017年3月</p>
                <ul class="item-ul">
                    <li class="item-list">
                        <div>
                            <p class="fb">提现成功</p>
                            <p class="fs">3-13 15:38</p>
                        </div>
                        <div>
                            <p class="fb">-109.33元</p>
                            <p class="fs">余额：100.00元</p>
                        </div>
                    </li>
                    <li class="item-list">
                        <div>
                            <p class="fb">个体贷【GTD20170903-01】还息个体贷【GTD20170903-01】还息</p>
                            <p class="fs">3-13 15:38</p>
                        </div>
                        <div>
                            <p class="fb">-109.33元</p>
                            <p class="fs">余额：1000000000.00元</p>
                        </div>
                    </li>
                    <li class="item-list">
                        <div>
                            <p class="fb">个体贷【GTD20170903-01】还本</p>
                            <p class="fs">3-13 15:38</p>
                        </div>
                        <div>
                            <p class="fb">-109.33元</p>
                            <p class="fs">余额：100.00元</p>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="main-item">
                <p class="top-tit">2017年2月</p>
                <ul class="item-ul">
                    <li class="item-list">
                        <div>
                            <p class="fb">提现成功</p>
                            <p class="fs">3-13 15:38</p>
                        </div>
                        <div>
                            <p class="fb">-109.33元</p>
                            <p class="fs">余额：100.00元</p>
                        </div>
                    </li>
                    <li class="item-list">
                        <div>
                            <p class="fb">个体贷【GTD20170903-01】还息</p>
                            <p class="fs">3-13 15:38</p>
                        </div>
                        <div>
                            <p class="fb">-109.33元</p>
                            <p class="fs">余额：100.00元</p>
                        </div>
                    </li>
                    <li class="item-list">
                        <div>
                            <p class="fb">个体贷【GTD20170903-01】还本</p>
                            <p class="fs">3-13 15:38</p>
                        </div>
                        <div>
                            <p class="fb">-109.33元</p>
                            <p class="fs">余额：100.00元</p>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <!--加载更多-->
        <p class="add-more">更多<span class="mui-icon mui-icon-arrowdown"></span></p>
        <p class="add-more">暂无数据</p>
        <!--筛选弹窗-->
        <div class="check-layer">
            <div class="mask"></div>
            <div class="layer-main">
                <ul class="check-ul">
                    <li class="check-list active" data-index="1">不限</li>
                    <li class="check-list" data-index="2">充值</li>
                    <li class="check-list" data-index="3">提现</li>
                    <li class="check-list" data-index="4">直投</li>
                    <li class="check-list" data-index="5">债权转让</li>
                    <li class="check-list" data-index="6">回本收息</li>
                    <li class="check-list" data-index="7">系统奖励</li>
                </ul>
            </div>
        </div>
    </body>
    <script type="text/javascript" src="../../js/mui.min.js"></script>
    <script type="text/javascript">
        window.onload = function () {
            var topTits = document.getElementsByClassName('top-tit');
            var layer = document.querySelector('.check-layer');
            var checkLists = document.getElementsByClassName('check-list');
            var uls = document.getElementsByClassName('item-ul');
            uls = uls[uls.length-1];
            //页面滚动
            document.body.onscroll = function () {
                var sTop = document.documentElement.scrollTop || document.body.scrollTop;
                for (var i = 0;i<topTits.length;i++){
                    if(topTits[i].parentElement.offsetTop < sTop + 44){
                        topTits[i].className = 'top-tit fixed-top';
                    }else {
                        topTits[i].className = 'top-tit';
                    }
                }
            }
            //打开弹窗
            mui('.shaixuan').on('tap','img',function () {
                layer.style.display = 'block';
            })
            //筛选
            mui('.check-ul').on('tap','.check-list',function () {
                //console.log(this.dataset.index);//筛选依据
                for (var i = 0;i<checkLists.length;i++){
                    checkLists[i].className = 'check-list';
                }
                this.className = 'check-list active';
                layer.style.display = 'none';
            })
            //加载更多
            mui('body').on("tap",'.add-more',function () {
                var html = '';
                var html1 = '';
                //post请求
                mui.post('http://server-name/login.php',{
                        username:'username',
                        password:'password'
                    },function(data){
                        for (var i = 0;i<data.data.length;i++){
                            if(data.data[i].name == topTits[topTits.length-1].textContent){
                                for (var j = 0;j<data.data[i].res.length;j++){
                                    html += '<li class="item-list"><div><p class="fb">' +data.data[i].value[j].type+'</p><p class="fs">' +data.data[i].value[j].mdhi+'</p></div><div><p class="fb">'+data.data[i].value[j].affect_money+'元</p><p class="fs">余额：'+data.data[i].value[j].account_money+ '元</p></div></li>';
                                }
                                uls.innerHTML += html;
                            }else{
                                html1 += '<div class="main-item"><p class="top-tit">'+data.data[i].name+'</p><ul class="item-ul">';
                                for (var j = 0;j<data.data[i].res.length;j++){
                                    html1 += '<li class="item-list"><div><p class="fb">' +data.data[i].value[j].type+'</p><p class="fs">' +data.data[i].value[j].mdhi+'</p></div><div><p class="fb">'+data.data[i].value[j].affect_money+'元</p><p class="fs">余额：'+data.data[i].value[j].account_money+ '元</p></div></li>';
                                }
                                html1 += '</ul></div>';
                                document.querySelector('.main').innerHTML += html1;
                            }
                        }
                    },'json'
                );
            })
            //点击显示
            mui('.item-ul').on('tap','.item-list',function () {
                var msg = this.getElementsByClassName('fb')[0].textContent;
                var tips = document.getElementsByClassName('mui-toast-container')[0];
                if(tips){
                    document.body.removeChild(tips);
                }
                mui.toast(msg,{ duration:'short', type:'div' });
            })
        }
    </script>
</html>